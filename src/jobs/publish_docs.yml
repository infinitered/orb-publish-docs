description: "The main job that orchestrates the documentation update process."
docker:
  - image: cimg/node:16.13
parameters:
  project_name:
    type: string
    default: ""
    description: "The name of the package. Defaults to the repository name if empty."
  source_docs_path:
    type: string
    default: "./docs"
    description: "The path to the ir-docs folder in the repository. Defaults to './ir-docs'."
  label:
    type: string
    default: ""
    description: "The label for this section that will appear in the sidebar."
  description:
    type: string
    default: ""
    description: "The description of the category that this documentation where these docs will live in the sidebar."
  target_repo:
    type: string
    default: ""
    description: "The GitHub URL of the target repository where the documentation resides."
  git_username:
    type: string
    default: ""
    description: "The Git username for commit and push operations."
  git_email:
    type: string
    default: ""
    description: "The Git email for commit and push operations."
steps:
  - validate_params:
      git_email: <<parameters.git_email>>
      git_username: <<parameters.git_username>>
      target_repo: <<parameters.target_repo>>
      description: <<parameters.description>>
      label: <<parameters.label>>
      project_name: <<parameters.project_name>>
  - clone_required_repos:
      git_email: << parameters.git_email >>
      git_username: << parameters.git_username >>
      target_repo: << parameters.target_repo >>
  - copy_docs_to_target:
      project_name: << parameters.project_name >>
      source_docs_path: << parameters.source_docs_path >>
      label: << parameters.label >>
      description: << parameters.description >>
  - build_docusaurus:
      target_repo: << parameters.target_repo >>
      target_directory: "~/target_repo"
  - commit_and_push
