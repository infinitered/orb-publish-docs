description: >
  "Setup git and clone required repositories"
parameters:
  git_email:
    type: string
    default: ""
    description: "Email for Git configuration."
  git_username:
    type: string
    default: ""
    description: "Username for Git configuration."
  target_repo:
    type: string
    default: ""
    description: "The GitHub repository URL where the documentation resides."
steps:
  - checkout
  - run:
      name: Install Git
      command: |
        # Check if Git is already installed
        if git --version > /dev/null 2>&1; then
          echo "Git is already installed."
        else
          echo "Git not found. Installing..."
          # Update package lists and install Git
          sudo apt-get update || { echo "apt-get update failed"; exit 1; }
          sudo apt-get install -y git || { echo "Git installation failed"; exit 1; }
          echo "Git installed successfully."
        fi
  - run:
      name: Setup Git
      command: |
        # Configure Git username and email
        echo "Configuring Git username and email: << parameters.git_username >> -- << parameters.git_email >>"
        git config --global user.name "<< parameters.git_username >>" || { echo "Git username configuration failed"; exit 1; }
        git config --global user.email "<< parameters.git_email >>" || { echo "Git email configuration failed"; exit 1; }
  - run:
      name: Clone target repository
      command: git clone << parameters.target_repo >> ~/target_repo || { echo "Git clone failed"; exit 1; }
