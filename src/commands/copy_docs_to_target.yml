description: "Clones a docusaurus repo and adds the docs from the current repo to it."
parameters:
  project_name:
    type: string
    default: ""
    description: "The path where these documents will be located on the docs site: (i.e. /docs/{package-name}/getting-started.md)"
  source_docs_path:
    type: string
    default: "./docs"
    description: "The path to the directory containing the markdown files. Defaults to './docs'."
  target_docs_path:
    type: string
    default: "./docs"
    description: "The path to the directory containing the markdown files. Defaults to './docs'."
  label:
    type: string
    default: "package-name"
    description: "The label that will appear in the sidebar of the docs site. Should be the full name of the package in Title Case. (i.e. Ignite CLI, or React Native MLKit)."
  description:
    type: string
    default: ""
    description: "Short description of the package used in indexes etc."
steps:
  - run:
      name: Check if docs exist
      command: |
        if [ ! "$(ls -A << parameters.source_docs_path >>)" ]; then
          echo "Error: No files found in docs directory."
          exit 1
        fi
  - run:
      name: Copy docs to target repository
      command: |
        cp -R << parameters.source_docs_path >> ~/target_repo/<<parameters.target_docs_path>>/<< parameters.project_name >>
  - run:
      name: Move static content to appropriate folder
      command: |
        if [ "$(ls -A ~/target_repo/docs/<< parameters.project_name >>/static)" ]; then
          mv ~/target_repo/docs/<< parameters.project_name >>/static ~/target_repo/static/<< parameters.project_name >>/
        else
          echo "No static files to copy."
        fi

  - run:
      name: Create _category_.json
      command: >
        echo '{
          "label": "<< parameters.label >>",
          "link": {
            "type": "generated-index",
            "description": "<< parameters.description >>"
          }
        }' > ~/target_repo/docs/<< parameters.project_name >>/_category_.json
